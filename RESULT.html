<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<title>Kalkulator PDD - HOME</title>
	<link href="main.css" type="text/css" rel="stylesheet" />
	<script type='Text/JavaScript' src='scw.js'></script>
	<script type='Text/JavaScript' src='algoPDD.js'></script>
	<script type='text/javascript'>
		//global var
		var tempDateMDP = form.dateMDP.value;
		var tempDateRede = form.dateReady.value;
		//input tanpa temp
		var NoSPK = form.nomorSPK.value;
		var NamaPelanggan = form.namaPelanggan.value;
		var telpon = form.noTelepon.value;
		var hp = form.noHP.value;
		var NamaKendaraan = form.namaKendaraan.value;
		var WarnaKendaraan = form.warnaKendaraan.value;
		var PembayaranDll = form.PembayaranDLL.value;
		
		//holiday data
		var holidayData;
	
		function initPage()
		{
			document.getElementById("profil1").style.visibility="hidden";
			document.getElementById("profil2").style.visibility="hidden";
			setData();
			createTable();
			//setElement();
		}
		
		function parseDate(tempDate)
		{
			var newDate;
			newDate = tempDate.getDate();
			newDate += " "+monthNames[tempDate.getMonth()];
			newDate += " "+tempDate.getFullYear();
			
			return newDate;
		}
		
		function parseDateSlash(tempDate)
		{
			var newDate;
			newDate = tempDate.getDate();
			newDate += "/"+(tempDate.getMonth()+1);
			newDate += "/"+tempDate.getFullYear();
			
			return newDate;
		}
		
		function setData()
		{
			var a = tempDateMDP.split("/");
			tglMDP = new Date(a[2],a[1]-1,a[0]);
			
			a = tempDateRede.split("/");
			tglRede = new Date(a[2],a[1]-1,a[0]);
			
			tglTable = new Date(a[2],a[1]-1,1);
			
			//cek value MDP atau Ready
			var flagMDPRede;
			if(form.paramMDP[0].checked)flagMDPRede = form.paramMDP[0].value;
			else flagMDPRede = form.paramMDP[1].value;
			//--------------------------------------------------------------------
			
			//cek Pelunasan
			var flagPembayaran;
			if(form.paramPembayaran[0].checked) {
				flagPembayaran = form.paramPembayaran[0].value;
			}
			else if(form.paramPembayaran[1].checked) {
				flagPembayaran = form.paramPembayaran[1].value;
			}
			else if(form.paramPembayaran[2].checked) {
				flagPembayaran = form.paramPembayaran[2].value;
			}
			else if(form.paramPembayaran[3].checked) {
				flagPembayaran = form.paramPembayaran[3].value;
			}
			else {
				flagPembayaran = form.PembayaranDLL.value;
			}
			TglPelunasan = new Date(tglRede);
			if(flagPembayaran == "cash" && form.paramBedaBank.checked) {
				for(i=0;i<3;i++){
					TglPelunasan.setDate(TglPelunasan.getDate()+1);
					if(TglPelunasan.getDay()==6 || TglPelunasan.getDay()==0 )i--;
					else {
						if(arrayDate.indexOf(parseDateSlash(TglPelunasan)) != -1)
							i--;
					}
				}
	
			}
			else if(flagPembayaran == "cash") {
					for(i=0;i<2;i++) {
					TglPelunasan.setDate(TglPelunasan.getDate()+1);
					if(TglPelunasan.getDay()==6 || TglPelunasan.getDay()==0 )i--;
					else {
						if(arrayDate.indexOf(parseDateSlash(TglPelunasan)) != -1)
							i--;
					}
				}
			}
			else {
				for(i=0;i<4;i++) {
					TglPelunasan.setDate(TglPelunasan.getDate()+1);
					if(TglPelunasan.getDay()==6 || TglPelunasan.getDay()==0 ) {
						i--;
					}
					else {
						if(arrayDate.indexOf(parseDateSlash(TglPelunasan)) != -1) {
							i--;
						}
					}
				}
			}
			//----------------------------------------------------------------------
			
			//tanggal AFI
			TglAFI = new Date(TglPelunasan);
			for(i=0;i<1;i++) {
					TglAFI.setDate(TglAFI.getDate()+1);
					if(TglAFI.getDay()==6 || TglAFI.getDay()==0 ) {
						i--;
					}	
					else {
						if(arrayDate.indexOf(parseDateSlash(TglAFI)) != -1)i--;
					}
			}
			//----------------------------------------------------------------------
			
			//cek STNK
			var flagSTNK;
			if(form.paramSTNK[0].checked)flagSTNK = form.paramSTNK[0].value;
			else flagSTNK = form.paramSTNK[1].value;
			if(flagSTNK == "nostnk") {
		
				//tanggal DR
				TglDR = new Date(TglAFI);
				for(i=0;i<1;i++){
					TglDR.setDate(TglDR.getDate()+1);
					if(TglDR.getDay()==0)i--;
					else {
						if(arrayDate.indexOf(parseDateSlash(TglDR)) != -1)i--;
					}
				}	
		
				//tanggal IN
				TglIN = new Date(TglDR);
				var valueDateCKD = document.getElementById("timeCKD").options[document.getElementById("timeCKD").selectedIndex].value;
				if(form.paramTipe[0].checked && valueDateCKD == "6" ) {		
						for(i=0;i<6;i++) {
							TglIN.setDate(TglIN.getDate()+1);
							if(TglIN.getDay()==0)i--;
							else {
								if(arrayDate.indexOf(parseDateSlash(TglIN)) != -1)i--;
							}
						}
				}
				else{
						for(i=0;i<4;i++){
							TglIN.setDate(TglIN.getDate()+1);
							if(TglIN.getDay()==0)i--;
							else {
								if(arrayDate.indexOf(parseDateSlash(TglIN)) != -1)i--;
							}
						}
				}	
			}
			else if(form.paramPilPol.checked){
				
				//tanggal H - 1
				TglHmin1 = new Date(TglAFI);
				var valueDateCKD = document.getElementById("timeCKD").options[document.getElementById("timeCKD").selectedIndex].value;
				//jika CKD
				if(form.paramTipe[0].checked) {
					for(i=0;i<17;i++) {
						TglHmin1.setDate(TglHmin1.getDate()+1);
						if(TglHmin1.getDay()==0 || TglHmin1.getDay()== 6)i--;
						else {
							if(arrayDate.indexOf(parseDateSlash(TglHmin1)) != -1)i--;
						}
					}
				}
				//jike CBU
				else {								
					for(i=0;i<30;i++) {
						TglHmin1.setDate(TglHmin1.getDate()+1);
						if(TglHmin1.getDay()==0 || TglHmin1.getDay()==6)i--;
						else {
							if(arrayDate.indexOf(parseDateSlash(TglHmin1)) != -1) {
								i--;
							}
						}
					}
				}
		
				//tanggal IN
				TglIN = new Date(TglHmin1);
				for(i=0;i<1;i++){
					TglIN.setDate(TglIN.getDate()-1);
					if(TglIN.getDay()==0) { 
						i--;
					}
					else {
								if(arrayDate.indexOf(parseDateSlash(TglIN)) != -1)i--;
					}
				}
		
				//tanggal DR
				TglDR = new Date(TglIN);
				if(form.paramTipe[0].checked && valueDateCKD == "6" ){		
						for(i=0;i<6;i++){
							TglDR.setDate(TglDR.getDate()-1);
							if(TglDR.getDay()==0)i--;
							else {
								if(arrayDate.indexOf(parseDateSlash(TglDR)) != -1)i--;
							}
						}
				}
				else{
						for(i=0;i<4;i++){
							TglDR.setDate(TglDR.getDate()-1);
							if(TglDR.getDay()==0)i--;
							else {
								if(arrayDate.indexOf(parseDateSlash(TglDR)) != -1)i--;
							}
						}
				}
			}
			else if(flagSTNK == "stnk") {
				//tanggal H - 1
				TglHmin1 = new Date(TglAFI);
				var valueDateCKD = document.getElementById("timeCKD").options[document.getElementById("timeCKD").selectedIndex].value;
				//jika CKD
				if(form.paramTipe[0].checked) {
						for(i=0;i<10;i++){
							TglHmin1.setDate(TglHmin1.getDate()+1);
							if(TglHmin1.getDay()==0 || TglHmin1.getDay()== 6)i--;
							else {
								if(arrayDate.indexOf(parseDateSlash(TglHmin1)) != -1)i--;
							}
						}
				}
				//jike CBU
				else {							
						for(i=0;i<25;i++){
							TglHmin1.setDate(TglHmin1.getDate()+1);
							if(TglHmin1.getDay()==0 || TglHmin1.getDay()==6)i--;
							else {
								if(arrayDate.indexOf(parseDateSlash(TglHmin1)) != -1)i--;
							}
						}
				}	
				//tanggal IN
				TglIN = new Date(TglHmin1);
				for(i=0;i<1;i++) {
					TglIN.setDate(TglIN.getDate()-1);
					if(TglIN.getDay()==0)i--;
					else {
						if(arrayDate.indexOf(parseDateSlash(TglIN)) != -1)i--;
					}
				}
		
				//tanggal DR
				TglDR = new Date(TglIN);
				if(form.paramTipe[0].checked && valueDateCKD == "6" ){		
					for(i=0;i<6;i++){
						TglDR.setDate(TglDR.getDate()-1);
						if(TglDR.getDay()==0)i--;
						else {
							if(arrayDate.indexOf(parseDateSlash(TglDR)) != -1)i--;
						}
					}
				}
				else {
					for(i=0;i<4;i++){
						TglDR.setDate(TglDR.getDate()-1);
						if(TglDR.getDay()==0)i--;
						else {
							if(arrayDate.indexOf(parseDateSlash(TglDR)) != -1)i--;
						}
					}
				}
			}
			//----------------------------------------------------------------------
			
			//tanggal BSTB
			TglPenyerahan = new Date(TglIN);
			for(i=0;i<2;i++) {
				TglPenyerahan.setDate(TglPenyerahan.getDate()+1);
				if(TglPenyerahan.getDay()==0 )i--;
				else {
					if(arrayDate.indexOf(parseDateSlash(TglPenyerahan)) != -1)i--;
				}
			}
		}
	
		function createTable()
		{	
			/*var listBulan = [29,31,28,31,30,31,30,31,31,30,31,30,31];
			var bulanReady;
			if(form.paramMDP[0].checked) { 
				tmpSplit = form.dateMDP.value.split('/');
				tmpDate = new Date(tmpSplit[2], tmpSplit[1], tmpSplit[1]);
				tmpDate.setDate(tmpDate.getDate()+2);
				tmpSplit = tmpDate.value.split('/');
				bulanReady = tmpSplit[1];
			}
			else {
				tmpSplit = form.dateReady.value.split('/');
				bulanReady = tmpSplit[1];
			}*/
			
			//month1
			var start = 1;
			var day = 31;
			var table = "<table border='1px' width='600px' height='480px'>" + 
						"<tr>" +
							"<th>" +
								"<span id='h1'></span>" +
							"</th>" + 
							"<th>" +
								"<span id='h2'></span>" +
							"</th>" + 
							"<th>" +
								"<span id='h3'></span>" +
							"</th>" + 
							"<th>" +
								"<span id='h4'></span>" +
							"</th>" + 
							"<th>" +
								"<span id='h5'></span>" +
							"</th>" + 
							"<th>" +
								"<span id='h6'></span>" +
							"</th>" + 
							"<th>" +
								"<span id='h7'></span>" +
							"</th>" +
						"</tr>" + "<tr>";
			var filledTable = fillTable(start, day);
			table += filledTable;
			document.getElementById("profil1").innerHTML = table;
			
			//month2
			/*var day2 = 62;
			var table2 = "<table border='1px' width='600px' height='480px'>" + 
						"<tr>" +
							"<th>" +
								"<span id='h8'></span>" +
							"</th>" + 
							"<th>" +
								"<span id='h9'></span>" +
							"</th>" + 
							"<th>" +
								"<span id='h10'></span>" +
							"</th>" + 
							"<th>" +
								"<span id='h11'></span>" +
							"</th>" + 
							"<th>" +
								"<span id='h12'></span>" +
							"</th>" + 
							"<th>" +
								"<span id='h13'></span>" +
							"</th>" + 
							"<th>" +
								"<span id='h14'></span>" +
							"</th>" +
						"</tr>" + "<tr>";
			for(i = day; i <= day2; i++) {
				table2 += "<td id='d" + i +"' ><div id='mini-Date'><span>" + i + "</span></div><p id='isi" + i + "'></p></td>";
				if(i%7 == 0 && i == day) {
					table2 += "</tr></table>";
				}
				else if(i%7 == 0) {
					table2 += "</tr>" + "<tr>";
				}
			}*/
		}
		
		function fillTable(start, day)
		{
			var table = "";
			for(i = start; i <= day; i++) {
				table += "<td id='d" + i +"' ><div id='mini-Date'><span>" + i + "</span></div><p id='isi" + i + "'></p></td>";
				if(i%7 == 0 && i == day) {
					table += "</tr></table>";
				}
				else if(i%7 == 0) {
					table += "</tr>" + "<tr>";
				}
			}
			
			return table;
		}
		
		function setElement()
		{
		}
	</script>
</head>

<body onload="initPage();">
	<div id="top"> 
            <div  align="center"><img src="logo plato.jpg" width="215" height="43"/></div>
    </div>
	<div id="container">   
        <div id="content-wrap">
            <span id="paramBulan1"></span>
        	<div id="profil1" align="center">
            </div>
			<div id="moreMonth"></div>
            <span id="paramBulan2"></span>
            <div id="profil2" align="center">
            </div>
            <div id="lebihDate" align="center">
            </div>
        </div>
        
        <div id="bottom">
        	<div>
                <img src="footer.jpg" width="900" height="34" />
                Copyright 2012
            </div>
        </div>
    </div>
</body>
</html>
